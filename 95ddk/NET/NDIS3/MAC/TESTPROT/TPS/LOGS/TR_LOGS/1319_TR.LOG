[TPCTL:] ReadScript \tps\scripts\1\3\1\9\1.tps
[TPCTL:] #	-SECTION_START-( 1.00 ) -SECTION_DESC-( "Send Functional, Receive Directed & Broadcast" )
[TPCTL:] ##
[TPCTL:] ## TITLE: 1.3.1.9.1 Send Functional, Receive Directed & Broadcast (1M/2C/1O)
[TPCTL:] ##
[TPCTL:] ## 1 Machine - 2 Cards - 1 Open Instance on each card.  These tests
[TPCTL:] ## will have a trusted card send 10 FUNCTIONAL packets to the card
[TPCTL:] ## being tested.  The card being tested will have its packetfilter
[TPCTL:] ## set to receive DIRECTED and BROADCAST packets.  Packets of size
[TPCTL:] ## 40 bytes, 512 bytes, and MAX_FRAME_SIZE bytes will be sent.
[TPCTL:] ##
[TPCTL:] ## No packets should be received by the test card.
[TPCTL:] ##
[TPCTL:] 
[TPCTL:] # First dump any outstanding unexpected events to clear
[TPCTL:] # the event queue.  This "should" be empty here.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 1.01 )
[TPCTL:] GetEvents                                       +
	     OpenInstance=1

	Tpctl: Event Queue is empty.	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 1.01 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 1.02 )
[TPCTL:] GetEvents                                       +
	     OpenInstance=2

	Tpctl: Event Queue is empty.	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 1.02 )
[TPCTL:] 
[TPCTL:] # And open and setup the cards.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 1.03 )
[TPCTL:] Open                                            +
	     OpenInstance=1                              +
	     AdapterName=TP_TRUSTED_CARD   MAY_DIFFER

	Tpctl: The Open command has been issued.

	CmdCode = Open
	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 1.03 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 1.04 )
[TPCTL:] Open                                            +
	     OpenInstance=2                              +
	     AdapterName=TP_TEST_CARD   MAY_DIFFER

	Tpctl: The Open command has been issued.

	CmdCode = Open
	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 1.04 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 1.05 )
[TPCTL:] SetPacketFilter                                 +
	     OpenInstance=2                              +
	     PacketFilter=DIRECTED|BROADCAST

	Tpctl: The SetPacketFilter command has been issued.

	CmdCode = SetPacketFilter

	    OID = 0x0001010E
            "OID_GEN_CURRENT_PACKET_FILTER"

	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE		MAY_DIFFER

	**********************************
[TPCTL:] #	-SECTION_END-( 1.05 )
[TPCTL:] 
[TPCTL:] # Now set the test card to receive packets,
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 1.06 )
[TPCTL:] Receive                                         +
	     OpenInstance=2

	Tpctl: The Receive command has been issued.
[TPCTL:] #	-SECTION_END-( 1.06 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 40 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 1.07 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=40                               +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 1.07 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 1.08 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 1.08 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 512 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 1.09 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=512                              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 1.09 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 1.10 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 1.10 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send "MAXIMUM FRAME SIZE" byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 1.11 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=TP_MAX_FRAME_SIZE   MAY_DIFFER              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 1.11 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 1.12 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 1.12 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Then stop the receive and dump the statistics.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 1.13 )
[TPCTL:] StopReceive                                     +
	     OpenInstance=2

	Tpctl: The StopReceive command has been issued.

	Packet Receives                =          0
	Packet Receive Completes       =          0	MAY_DIFFER
	Corrupt Receives               =          0

	RESEND initiated Packet Sends          =          0
	RESEND initiated Packet Send Pends     =          0	MAY_DIFFER
	RESEND initiated Packet Send Completes =          0	EQUAL_LAST
	RESEND initiated Packet Send Fails     =          0

	Packet Transfer Data           =          0
	Packet Transfer Data Pends     =          0	MAY_DIFFER
	Packet Transfer Data Completes =          0	EQUAL_LAST
	Packet Transfer Data Fails     =          0
[TPCTL:] #	-SECTION_END-( 1.13 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Finally close the adapters, and again dump the Event
[TPCTL:] # Queue for any unexpected events.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 1.14 )
[TPCTL:] Close                                           +
	     OpenInstance=1

	Tpctl: The Close command has been issued.

	CmdCode = Close
	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 1.14 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 1.15 )
[TPCTL:] Close                                           +
	     OpenInstance=2

	Tpctl: The Close command has been issued.

	CmdCode = Close
	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 1.15 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 1.16 )
[TPCTL:] GetEvents                                       +
	     OpenInstance=1

	Tpctl: Event Queue is empty.	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 1.16 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 1.17 )
[TPCTL:] GetEvents                                       +
	     OpenInstance=2

	Tpctl: Event Queue is empty.	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 1.17 )
[TPCTL:] 
[TPCTL:] #	-SECTION_END-( 1.00 )
[TPCTL:] ReadScript \tps\scripts\1\3\1\9\2.tps
[TPCTL:] #	-SECTION_START-( 2.00 ) -SECTION_DESC-( "Send Functional, Receive Directed & Functional" )
[TPCTL:] ##
[TPCTL:] ## TITLE: 1.3.1.9.2 Send Functional, Receive Directed & Functional (1M/2C/1O)
[TPCTL:] ##
[TPCTL:] ## 1 Machine - 2 Cards - 1 Open Instance on each card.  These tests
[TPCTL:] ## will have a trusted card send 10 FUNCTIONAL packets to the card
[TPCTL:] ## being tested.  The card being tested will have its packetfilter
[TPCTL:] ## set to receive DIRECTED and FUNCTIONAL packets.  Packets of size
[TPCTL:] ## 40 bytes, 512 bytes, and MAX_FRAME_SIZE bytes will be sent.
[TPCTL:] ##
[TPCTL:] ## All packets should be received by the test card when the proper
[TPCTL:] ## functional address is set, and No packets should be received when
[TPCTL:] ## no address is set, or the wrong address is set.
[TPCTL:] ##
[TPCTL:] 
[TPCTL:] # First dump any outstanding unexpected events to clear
[TPCTL:] # the event queue.  This "should" be empty here.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.01 )
[TPCTL:] GetEvents                                       +
	     OpenInstance=1

	Tpctl: Event Queue is empty.	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 2.01 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.02 )
[TPCTL:] GetEvents                                       +
	     OpenInstance=2

	Tpctl: Event Queue is empty.	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 2.02 )
[TPCTL:] 
[TPCTL:] # And open and setup the cards.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.03 )
[TPCTL:] Open                                            +
	     OpenInstance=1                              +
	     AdapterName=TP_TRUSTED_CARD   MAY_DIFFER

	Tpctl: The Open command has been issued.

	CmdCode = Open
	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 2.03 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.04 )
[TPCTL:] Open                                            +
	     OpenInstance=2                              +
	     AdapterName=TP_TEST_CARD   MAY_DIFFER

	Tpctl: The Open command has been issued.

	CmdCode = Open
	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 2.04 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.05 )
[TPCTL:] SetPacketFilter                                 +
	     OpenInstance=2                              +
	     PacketFilter=DIRECTED|FUNCTIONAL

	Tpctl: The SetPacketFilter command has been issued.

	CmdCode = SetPacketFilter

	    OID = 0x0001010E
            "OID_GEN_CURRENT_PACKET_FILTER"

	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE		MAY_DIFFER

	**********************************
[TPCTL:] #	-SECTION_END-( 2.05 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Now set the test card to receive packets,
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.06 )
[TPCTL:] Receive                                         +
	     OpenInstance=2

	Tpctl: The Receive command has been issued.
[TPCTL:] #	-SECTION_END-( 2.06 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # With the no functional address set no packets
[TPCTL:] # should be received.
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 40 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.07 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=40                               +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 2.07 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.08 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 2.08 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 512 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.09 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=512                              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 2.09 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.10 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 2.10 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send "MAXIMUM FRAME SIZE" byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.11 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=TP_MAX_FRAME_SIZE   MAY_DIFFER              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 2.11 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.12 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 2.12 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Then stop the receive and dump the statistics.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.13 )
[TPCTL:] StopReceive                                     +
	     OpenInstance=2

	Tpctl: The StopReceive command has been issued.

	Packet Receives                =          0
	Packet Receive Completes       =          0	MAY_DIFFER
	Corrupt Receives               =          0

	RESEND initiated Packet Sends          =          0
	RESEND initiated Packet Send Pends     =          0	MAY_DIFFER
	RESEND initiated Packet Send Completes =          0	EQUAL_LAST
	RESEND initiated Packet Send Fails     =          0

	Packet Transfer Data           =          0
	Packet Transfer Data Pends     =          0	MAY_DIFFER
	Packet Transfer Data Completes =          0	EQUAL_LAST
	Packet Transfer Data Fails     =          0
[TPCTL:] #	-SECTION_END-( 2.13 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.14 )
[TPCTL:] Receive                                         +
	     OpenInstance=2

	Tpctl: The Receive command has been issued.
[TPCTL:] #	-SECTION_END-( 2.14 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # With the correct functional address set all packets
[TPCTL:] # should be received.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.15 )
[TPCTL:] SetFunctionalAddress                            +
	     OpenInstance=2                              +
	     FunctionalAddress=TP_FUNCTIONAL_ADDRESS   MAY_DIFFER

	Tpctl: The SetFunctionalAddress command has been issued.

	CmdCode = SetFunctionalAddress

	    OID = 0x02010103
            "OID_802_5_CURRENT_FUNCTIONAL"

	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE		MAY_DIFFER

	**********************************
[TPCTL:] #	-SECTION_END-( 2.15 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 40 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.16 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=40                               +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 2.16 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.17 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 2.17 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 512 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.18 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=512                              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 2.18 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.19 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 2.19 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # send "MAXIMUM FRAME SIZE" byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.20 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=TP_MAX_FRAME_SIZE   MAY_DIFFER              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 2.20 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.21 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 2.21 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Then stop the receive and dump the statistics.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.22 )
[TPCTL:] StopReceive                                     +
	     OpenInstance=2

	Tpctl: The StopReceive command has been issued.

	Packet Receives                =         30
	Packet Receive Completes       =         30	MAY_DIFFER
	Corrupt Receives               =          0

	RESEND initiated Packet Sends          =          0
	RESEND initiated Packet Send Pends     =          0	MAY_DIFFER
	RESEND initiated Packet Send Completes =          0	EQUAL_LAST
	RESEND initiated Packet Send Fails     =          0

	Packet Transfer Data           =         30
	Packet Transfer Data Pends     =          0	MAY_DIFFER
	Packet Transfer Data Completes =          0	EQUAL_LAST
	Packet Transfer Data Fails     =          0
[TPCTL:] #	-SECTION_END-( 2.22 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.23 )
[TPCTL:] Receive                                         +
	     OpenInstance=2

	Tpctl: The Receive command has been issued.
[TPCTL:] #	-SECTION_END-( 2.23 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # With the incorrect functional address set no packets
[TPCTL:] # should be received.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.24 )
[TPCTL:] SetFunctionalAddress                            +
	     OpenInstance=2                              +
	     FunctionalAddress=TP_FUNCTIONAL_ADDRESS2   MAY_DIFFER

	Tpctl: The SetFunctionalAddress command has been issued.

	CmdCode = SetFunctionalAddress

	    OID = 0x02010103
            "OID_802_5_CURRENT_FUNCTIONAL"

	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE		MAY_DIFFER

	**********************************
[TPCTL:] #	-SECTION_END-( 2.24 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 40 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.25 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=40                               +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 2.25 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.26 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 2.26 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 512 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.27 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=512                              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 2.27 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.28 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 2.28 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send "MAXIMUM FRAME SIZE" byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.29 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=TP_MAX_FRAME_SIZE   MAY_DIFFER              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 2.29 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.30 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 2.30 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Then stop the receive and dump the statistics.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.31 )
[TPCTL:] StopReceive                                     +
	     OpenInstance=2

	Tpctl: The StopReceive command has been issued.

	Packet Receives                =          0
	Packet Receive Completes       =          0	MAY_DIFFER
	Corrupt Receives               =          0

	RESEND initiated Packet Sends          =          0
	RESEND initiated Packet Send Pends     =          0	MAY_DIFFER
	RESEND initiated Packet Send Completes =          0	EQUAL_LAST
	RESEND initiated Packet Send Fails     =          0

	Packet Transfer Data           =          0
	Packet Transfer Data Pends     =          0	MAY_DIFFER
	Packet Transfer Data Completes =          0	EQUAL_LAST
	Packet Transfer Data Fails     =          0
[TPCTL:] #	-SECTION_END-( 2.31 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.32 )
[TPCTL:] Receive                                         +
	     OpenInstance=2

	Tpctl: The Receive command has been issued.
[TPCTL:] #	-SECTION_END-( 2.32 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Finally close the adapters, and again dump the Event
[TPCTL:] # Queue for any unexpected events.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.33 )
[TPCTL:] Close                                           +
	     OpenInstance=1

	Tpctl: The Close command has been issued.

	CmdCode = Close
	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 2.33 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.34 )
[TPCTL:] Close                                           +
	     OpenInstance=2

	Tpctl: The Close command has been issued.

	CmdCode = Close
	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 2.34 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.35 )
[TPCTL:] GetEvents                                       +
	     OpenInstance=1

	Tpctl: Event Queue is empty.	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 2.35 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 2.36 )
[TPCTL:] GetEvents                                       +
	     OpenInstance=2

	Tpctl: Event Queue is empty.	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 2.36 )
[TPCTL:] 
[TPCTL:] #	-SECTION_END-( 2.00 )
[TPCTL:] ReadScript \tps\scripts\1\3\1\9\3.tps
[TPCTL:] #	-SECTION_START-( 3.00 ) -SECTION_DESC-( "Send Functional, Receive Broadcast & Functional" )
[TPCTL:] ##
[TPCTL:] ## TITLE: 1.3.1.9.3 Send Functional, Receive Broadcast & Functional (1M/2C/1O)
[TPCTL:] ##
[TPCTL:] ## 1 Machine - 2 Cards - 1 Open Instance on each card.  These tests
[TPCTL:] ## will have a trusted card send 10 FUNCTIONAL packets to the card
[TPCTL:] ## being tested.  The card being tested will have its packetfilter
[TPCTL:] ## set to receive BROADCAST and FUNCTIONAL packets.  Packets of size
[TPCTL:] ## 40 bytes, 512 bytes, and MAX_FRAME_SIZE bytes will be sent.
[TPCTL:] ##
[TPCTL:] ## All packets should be received by the test card when the proper
[TPCTL:] ## functional address is set, and No packets should be received when
[TPCTL:] ## no address is set, or the wrong address is set.
[TPCTL:] ##
[TPCTL:] 
[TPCTL:] # First dump any outstanding unexpected events to clear
[TPCTL:] # the event queue.  This "should" be empty here.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.01 )
[TPCTL:] GetEvents                                       +
	     OpenInstance=1

	Tpctl: Event Queue is empty.	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 3.01 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.02 )
[TPCTL:] GetEvents                                       +
	     OpenInstance=2

	Tpctl: Event Queue is empty.	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 3.02 )
[TPCTL:] 
[TPCTL:] # And open and setup the cards.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.03 )
[TPCTL:] Open                                            +
	     OpenInstance=1                              +
	     AdapterName=TP_TRUSTED_CARD   MAY_DIFFER

	Tpctl: The Open command has been issued.

	CmdCode = Open
	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 3.03 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.04 )
[TPCTL:] Open                                            +
	     OpenInstance=2                              +
	     AdapterName=TP_TEST_CARD   MAY_DIFFER

	Tpctl: The Open command has been issued.

	CmdCode = Open
	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 3.04 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.05 )
[TPCTL:] SetPacketFilter                                 +
	     OpenInstance=2                              +
	     PacketFilter=BROADCAST|FUNCTIONAL

	Tpctl: The SetPacketFilter command has been issued.

	CmdCode = SetPacketFilter

	    OID = 0x0001010E
            "OID_GEN_CURRENT_PACKET_FILTER"

	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE		MAY_DIFFER

	**********************************
[TPCTL:] #	-SECTION_END-( 3.05 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Now set the test card to receive packets,
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.06 )
[TPCTL:] Receive                                         +
	     OpenInstance=2

	Tpctl: The Receive command has been issued.
[TPCTL:] #	-SECTION_END-( 3.06 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # With the no functional address set no packets
[TPCTL:] # should be received.
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 40 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.07 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=40                               +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 3.07 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.08 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 3.08 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 512 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.09 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=512                              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 3.09 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.10 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 3.10 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send "MAXIMUM FRAME SIZE" byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.11 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=TP_MAX_FRAME_SIZE   MAY_DIFFER              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 3.11 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.12 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 3.12 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Then stop the receive and dump the statistics.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.13 )
[TPCTL:] StopReceive                                     +
	     OpenInstance=2

	Tpctl: The StopReceive command has been issued.

	Packet Receives                =          0
	Packet Receive Completes       =          0	MAY_DIFFER
	Corrupt Receives               =          0

	RESEND initiated Packet Sends          =          0
	RESEND initiated Packet Send Pends     =          0	MAY_DIFFER
	RESEND initiated Packet Send Completes =          0	EQUAL_LAST
	RESEND initiated Packet Send Fails     =          0

	Packet Transfer Data           =          0
	Packet Transfer Data Pends     =          0	MAY_DIFFER
	Packet Transfer Data Completes =          0	EQUAL_LAST
	Packet Transfer Data Fails     =          0
[TPCTL:] #	-SECTION_END-( 3.13 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.14 )
[TPCTL:] Receive                                         +
	     OpenInstance=2

	Tpctl: The Receive command has been issued.
[TPCTL:] #	-SECTION_END-( 3.14 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # With the correct functional address set all packets
[TPCTL:] # should be received.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.15 )
[TPCTL:] SetFunctionalAddress                            +
	     OpenInstance=2                              +
	     FunctionalAddress=TP_FUNCTIONAL_ADDRESS   MAY_DIFFER

	Tpctl: The SetFunctionalAddress command has been issued.

	CmdCode = SetFunctionalAddress

	    OID = 0x02010103
            "OID_802_5_CURRENT_FUNCTIONAL"

	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE		MAY_DIFFER

	**********************************
[TPCTL:] #	-SECTION_END-( 3.15 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 40 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.16 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=40                               +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 3.16 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.17 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 3.17 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 512 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.18 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=512                              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 3.18 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.19 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 3.19 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # send "MAXIMUM FRAME SIZE" byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.20 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=TP_MAX_FRAME_SIZE   MAY_DIFFER              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 3.20 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.21 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 3.21 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Then stop the receive and dump the statistics.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.22 )
[TPCTL:] StopReceive                                     +
	     OpenInstance=2

	Tpctl: The StopReceive command has been issued.

	Packet Receives                =         30
	Packet Receive Completes       =         30	MAY_DIFFER
	Corrupt Receives               =          0

	RESEND initiated Packet Sends          =          0
	RESEND initiated Packet Send Pends     =          0	MAY_DIFFER
	RESEND initiated Packet Send Completes =          0	EQUAL_LAST
	RESEND initiated Packet Send Fails     =          0

	Packet Transfer Data           =         30
	Packet Transfer Data Pends     =          0	MAY_DIFFER
	Packet Transfer Data Completes =          0	EQUAL_LAST
	Packet Transfer Data Fails     =          0
[TPCTL:] #	-SECTION_END-( 3.22 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.23 )
[TPCTL:] Receive                                         +
	     OpenInstance=2

	Tpctl: The Receive command has been issued.
[TPCTL:] #	-SECTION_END-( 3.23 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # With the incorrect functional address set no packets
[TPCTL:] # should be received.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.24 )
[TPCTL:] SetFunctionalAddress                            +
	     OpenInstance=2                              +
	     FunctionalAddress=TP_FUNCTIONAL_ADDRESS2   MAY_DIFFER

	Tpctl: The SetFunctionalAddress command has been issued.

	CmdCode = SetFunctionalAddress

	    OID = 0x02010103
            "OID_802_5_CURRENT_FUNCTIONAL"

	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE		MAY_DIFFER

	**********************************
[TPCTL:] #	-SECTION_END-( 3.24 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 40 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.25 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=40                               +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 3.25 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.26 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 3.26 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 512 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.27 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=512                              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 3.27 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.28 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 3.28 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send "MAXIMUM FRAME SIZE" byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.29 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=TP_MAX_FRAME_SIZE   MAY_DIFFER              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 3.29 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.30 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 3.30 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Then stop the receive and dump the statistics.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.31 )
[TPCTL:] StopReceive                                     +
	     OpenInstance=2

	Tpctl: The StopReceive command has been issued.

	Packet Receives                =          0
	Packet Receive Completes       =          0	MAY_DIFFER
	Corrupt Receives               =          0

	RESEND initiated Packet Sends          =          0
	RESEND initiated Packet Send Pends     =          0	MAY_DIFFER
	RESEND initiated Packet Send Completes =          0	EQUAL_LAST
	RESEND initiated Packet Send Fails     =          0

	Packet Transfer Data           =          0
	Packet Transfer Data Pends     =          0	MAY_DIFFER
	Packet Transfer Data Completes =          0	EQUAL_LAST
	Packet Transfer Data Fails     =          0
[TPCTL:] #	-SECTION_END-( 3.31 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.32 )
[TPCTL:] Receive                                         +
	     OpenInstance=2

	Tpctl: The Receive command has been issued.
[TPCTL:] #	-SECTION_END-( 3.32 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Finally close the adapters, and again dump the Event
[TPCTL:] # Queue for any unexpected events.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.33 )
[TPCTL:] Close                                           +
	     OpenInstance=1

	Tpctl: The Close command has been issued.

	CmdCode = Close
	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 3.33 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.34 )
[TPCTL:] Close                                           +
	     OpenInstance=2

	Tpctl: The Close command has been issued.

	CmdCode = Close
	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 3.34 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.35 )
[TPCTL:] GetEvents                                       +
	     OpenInstance=1

	Tpctl: Event Queue is empty.	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 3.35 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 3.36 )
[TPCTL:] GetEvents                                       +
	     OpenInstance=2

	Tpctl: Event Queue is empty.	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 3.36 )
[TPCTL:] 
[TPCTL:] #	-SECTION_END-( 3.00 )
[TPCTL:] ReadScript \tps\scripts\1\3\1\9\4.tps
[TPCTL:] #	-SECTION_START-( 4.00 ) -SECTION_DESC-( "Send Functional, Receive Directed & Broadcast & Functional Frame" )
[TPCTL:] ##
[TPCTL:] ## TITLE: 1.3.1.9.4 Send Functional, Receive Directed & Broadcast
[TPCTL:] ## TITLE:           & Functional Frame (1M/2C/1O)
[TPCTL:] ##
[TPCTL:] ## 1 Machine - 2 Cards - 1 Open Instance on each card.  These tests
[TPCTL:] ## will have a trusted card send 10 FUNCTIONAL packets to the card
[TPCTL:] ## being tested.  The card being tested will have its packetfilter
[TPCTL:] ## set to receive DIRECTED, BROADCAST and FUNCTIONAL packets.  Packets
[TPCTL:] ## of size 40 bytes, 512 bytes, and MAX_FRAME_SIZE bytes will be sent.
[TPCTL:] ##
[TPCTL:] ## All packets should be received by the test card when the proper
[TPCTL:] ## functional address is set, and No packets should be received when
[TPCTL:] ## no address is set, or the wrong address is set.
[TPCTL:] ##
[TPCTL:] 
[TPCTL:] # First dump any outstanding unexpected events to clear
[TPCTL:] # the event queue.  This "should" be empty here.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.01 )
[TPCTL:] GetEvents                                       +
	     OpenInstance=1

	Tpctl: Event Queue is empty.	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 4.01 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.02 )
[TPCTL:] GetEvents                                       +
	     OpenInstance=2

	Tpctl: Event Queue is empty.	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 4.02 )
[TPCTL:] 
[TPCTL:] # And open and setup the cards.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.03 )
[TPCTL:] Open                                            +
	     OpenInstance=1                              +
	     AdapterName=TP_TRUSTED_CARD   MAY_DIFFER

	Tpctl: The Open command has been issued.

	CmdCode = Open
	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 4.03 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.04 )
[TPCTL:] Open                                            +
	     OpenInstance=2                              +
	     AdapterName=TP_TEST_CARD   MAY_DIFFER

	Tpctl: The Open command has been issued.

	CmdCode = Open
	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 4.04 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.05 )
[TPCTL:] SetPacketFilter                                 +
	     OpenInstance=2                              +
	     PacketFilter=DIRECTED|BROADCAST|FUNCTIONAL

	Tpctl: The SetPacketFilter command has been issued.

	CmdCode = SetPacketFilter

	    OID = 0x0001010E
            "OID_GEN_CURRENT_PACKET_FILTER"

	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE		MAY_DIFFER

	**********************************
[TPCTL:] #	-SECTION_END-( 4.05 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Now set the test card to receive packets,
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.06 )
[TPCTL:] Receive                                         +
	     OpenInstance=2

	Tpctl: The Receive command has been issued.
[TPCTL:] #	-SECTION_END-( 4.06 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # With the no functional address set no packets
[TPCTL:] # should be received.
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 40 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.07 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=40                               +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 4.07 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.08 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 4.08 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 512 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.09 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=512                              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 4.09 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.10 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 4.10 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send "MAXIMUM FRAME SIZE" byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.11 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=TP_MAX_FRAME_SIZE   MAY_DIFFER              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 4.11 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.12 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 4.12 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Then stop the receive and dump the statistics.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.13 )
[TPCTL:] StopReceive                                     +
	     OpenInstance=2

	Tpctl: The StopReceive command has been issued.

	Packet Receives                =          0
	Packet Receive Completes       =          0	MAY_DIFFER
	Corrupt Receives               =          0

	RESEND initiated Packet Sends          =          0
	RESEND initiated Packet Send Pends     =          0	MAY_DIFFER
	RESEND initiated Packet Send Completes =          0	EQUAL_LAST
	RESEND initiated Packet Send Fails     =          0

	Packet Transfer Data           =          0
	Packet Transfer Data Pends     =          0	MAY_DIFFER
	Packet Transfer Data Completes =          0	EQUAL_LAST
	Packet Transfer Data Fails     =          0
[TPCTL:] #	-SECTION_END-( 4.13 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.14 )
[TPCTL:] Receive                                         +
	     OpenInstance=2

	Tpctl: The Receive command has been issued.
[TPCTL:] #	-SECTION_END-( 4.14 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # With the correct functional address set all packets
[TPCTL:] # should be received.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.15 )
[TPCTL:] SetFunctionalAddress                            +
	     OpenInstance=2                              +
	     FunctionalAddress=TP_FUNCTIONAL_ADDRESS   MAY_DIFFER

	Tpctl: The SetFunctionalAddress command has been issued.

	CmdCode = SetFunctionalAddress

	    OID = 0x02010103
            "OID_802_5_CURRENT_FUNCTIONAL"

	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE		MAY_DIFFER

	**********************************
[TPCTL:] #	-SECTION_END-( 4.15 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 40 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.16 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=40                               +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 4.16 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.17 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 4.17 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 512 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.18 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=512                              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 4.18 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.19 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 4.19 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # send "MAXIMUM FRAME SIZE" byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.20 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=TP_MAX_FRAME_SIZE   MAY_DIFFER              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 4.20 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.21 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 4.21 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Then stop the receive and dump the statistics.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.22 )
[TPCTL:] StopReceive                                     +
	     OpenInstance=2

	Tpctl: The StopReceive command has been issued.

	Packet Receives                =         30
	Packet Receive Completes       =         30	MAY_DIFFER
	Corrupt Receives               =          0

	RESEND initiated Packet Sends          =          0
	RESEND initiated Packet Send Pends     =          0	MAY_DIFFER
	RESEND initiated Packet Send Completes =          0	EQUAL_LAST
	RESEND initiated Packet Send Fails     =          0

	Packet Transfer Data           =         30
	Packet Transfer Data Pends     =          0	MAY_DIFFER
	Packet Transfer Data Completes =          0	EQUAL_LAST
	Packet Transfer Data Fails     =          0
[TPCTL:] #	-SECTION_END-( 4.22 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.23 )
[TPCTL:] Receive                                         +
	     OpenInstance=2

	Tpctl: The Receive command has been issued.
[TPCTL:] #	-SECTION_END-( 4.23 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # With the incorrect functional address set no packets
[TPCTL:] # should be received.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.24 )
[TPCTL:] SetFunctionalAddress                            +
	     OpenInstance=2                              +
	     FunctionalAddress=TP_FUNCTIONAL_ADDRESS2   MAY_DIFFER

	Tpctl: The SetFunctionalAddress command has been issued.

	CmdCode = SetFunctionalAddress

	    OID = 0x02010103
            "OID_802_5_CURRENT_FUNCTIONAL"

	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE		MAY_DIFFER

	**********************************
[TPCTL:] #	-SECTION_END-( 4.24 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 40 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.25 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=40                               +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 4.25 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.26 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 4.26 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send 512 byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.27 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=512                              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 4.27 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.28 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 4.28 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Send "MAXIMUM FRAME SIZE" byte packets.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.29 )
[TPCTL:] Send                                            +
	     OpenInstance=1                              +
	     DestinationAddress=C0-00-TP_FUNCTIONAL_ADDRESS   MAY_DIFFER +
	     PacketSize=TP_MAX_FRAME_SIZE   MAY_DIFFER              +
	     Number=10

	Tpctl: The Send command has been issued.
[TPCTL:] #	-SECTION_END-( 4.29 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.30 )
[TPCTL:] WaitSend                                        +
	     OpenInstance=1

	Packet Sends          =         10
	Packet Pends          =         10	MAY_DIFFER
	Packet Send Completes =         10	EQUAL_LAST
	Packet Send Fails     =          0
[TPCTL:] #	-SECTION_END-( 4.30 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Then stop the receive and dump the statistics.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.31 )
[TPCTL:] StopReceive                                     +
	     OpenInstance=2

	Tpctl: The StopReceive command has been issued.

	Packet Receives                =          0
	Packet Receive Completes       =          0	MAY_DIFFER
	Corrupt Receives               =          0

	RESEND initiated Packet Sends          =          0
	RESEND initiated Packet Send Pends     =          0	MAY_DIFFER
	RESEND initiated Packet Send Completes =          0	EQUAL_LAST
	RESEND initiated Packet Send Fails     =          0

	Packet Transfer Data           =          0
	Packet Transfer Data Pends     =          0	MAY_DIFFER
	Packet Transfer Data Completes =          0	EQUAL_LAST
	Packet Transfer Data Fails     =          0
[TPCTL:] #	-SECTION_END-( 4.31 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.32 )
[TPCTL:] Receive                                         +
	     OpenInstance=2

	Tpctl: The Receive command has been issued.
[TPCTL:] #	-SECTION_END-( 4.32 )
[TPCTL:] 
[TPCTL:] ########################################################
[TPCTL:] 
[TPCTL:] # Finally close the adapters, and again dump the Event
[TPCTL:] # Queue for any unexpected events.
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.33 )
[TPCTL:] Close                                           +
	     OpenInstance=1

	Tpctl: The Close command has been issued.

	CmdCode = Close
	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 4.33 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.34 )
[TPCTL:] Close                                           +
	     OpenInstance=2

	Tpctl: The Close command has been issued.

	CmdCode = Close
	Return Status = NDIS_STATUS_SUCCESS
	Request Pended = TRUE	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 4.34 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.35 )
[TPCTL:] GetEvents                                       +
	     OpenInstance=1

	Tpctl: Event Queue is empty.	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 4.35 )
[TPCTL:] 
[TPCTL:] #	-SECTION_START-( 4.36 )
[TPCTL:] GetEvents                                       +
	     OpenInstance=2

	Tpctl: Event Queue is empty.	MAY_DIFFER
[TPCTL:] #	-SECTION_END-( 4.36 )
[TPCTL:] 
[TPCTL:] #	-SECTION_END-( 4.00 )
