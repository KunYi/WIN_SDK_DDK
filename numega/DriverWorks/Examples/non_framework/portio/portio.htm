<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./portio_files/filelist.xml">
<title>PORTIO</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Sarah Prevost</o:Author>
  <o:LastAuthor>Sarah Prevost</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>35</o:TotalTime>
  <o:Created>2000-09-06T16:42:00Z</o:Created>
  <o:LastSaved>2000-09-06T17:17:00Z</o:LastSaved>
  <o:Pages>2</o:Pages>
  <o:Words>481</o:Words>
  <o:Characters>2742</o:Characters>
  <o:Company>Compuware Numega</o:Company>
  <o:Lines>22</o:Lines>
  <o:Paragraphs>5</o:Paragraphs>
  <o:CharactersWithSpaces>3367</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536871559 0 0 0 415 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
h2
	{color:black;}
h3
	{color:black;}
h4
	{color:black;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;
	text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	color:black;}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Courier New";
	color:black;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:572204793;
	mso-list-type:hybrid;
	mso-list-template-ids:-942750922 67698695 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F071;
	mso-level-tab-stop:63.0pt;
	mso-level-number-position:left;
	margin-left:63.0pt;
	text-indent:-.25in;
	mso-ansi-font-size:8.0pt;
	font-family:Wingdings;}
@list l1
	{mso-list-id:1736511365;
	mso-list-type:hybrid;
	mso-list-template-ids:915598880 67698695 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F071;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:8.0pt;
	font-family:Wingdings;}
@list l1:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l2
	{mso-list-id:1743672146;
	mso-list-type:hybrid;
	mso-list-template-ids:-1823716228 -1780159488 1660980178 1725961952 -476039352 732985798 756331614 -185425786 -1216190802 -1800213594;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1027"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
<meta name=Template content="C:\PROGRAM FILES\MICROSOFT OFFICE\OFFICE\html.dot">
</head>

<body bgcolor=white lang=EN-US link=blue vlink=purple style='tab-interval:.5in'
leftmargin=8>

<div class=Section1>

<h2><a name=MYSAMPLE><span style='font-family:Verdana'>PORTIO</span></a><span
style='font-family:Verdana'> <o:p></o:p></span></h2>

<h3><span style='font-family:Verdana'>C++ Version of the DDK Sample<o:p></o:p></span></h3>

<p><span style='font-size:10.0pt;font-family:Verdana'>This sample is based very
closely on the DDK sample of the same name. Its purpose is to illustrate how an
existing driver written strictly to the DDK can be modified to take advantage
of various DriverWorks classes, without using the DriverWorks framework for IRP
dispatching. <o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'>Only the file genport.c
has been modified from the original (now genport.cpp). <o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'>This generic port I/O
device driver sample shows how to reserve I/O ports and read and write to it
from an user application. <o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'>The driver building and
installation instructions given here only apply to Windows® 2000.<o:p></o:p></span></p>

<h3><span style='font-family:Verdana'>BUILDING THE SAMPLE<o:p></o:p></span></h3>

<p><span style='font-size:10.0pt;font-family:Verdana'>The files necessary to build
this sample include genport.cpp, genport.h, genport.rc, the
makefile, and the sources. Once built, it produces one binary (genport.sys). Free and checked builds are both available.<o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'>The sample can be built
from either the command line or from the Visual C++ IDE.<span
style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l1 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:8.0pt;
mso-bidi-font-size:10.0pt;font-family:Wingdings'>q<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:10.0pt;font-family:Verdana'>To
build from the Visual C++ IDE, open the project, portio.dsw.<span
style="mso-spacerun: yes">  </span>PortIo contains three project files: <o:p></o:p></span></p>

<p style='margin-left:1.0in;text-indent:-.25in;mso-list:l1 level2 lfo4;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:10.0pt;font-family:Verdana'>GENPORT:
builds the driver: genport.sys<span style="mso-spacerun: yes">  </span><o:p></o:p></span></p>

<p style='margin-left:1.0in;text-indent:-.25in;mso-list:l1 level2 lfo4;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:10.0pt;font-family:Verdana'>GPDREAD:
builds the read test application: gpdread.exe<o:p></o:p></span></p>

<p style='margin-left:1.0in;text-indent:-.25in;mso-list:l1 level2 lfo4;
tab-stops:list 1.0in'><![if !supportLists]><span style='font-size:10.0pt;
font-family:"Courier New";mso-bidi-font-family:"Times New Roman"'>o<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:10.0pt;font-family:Verdana'>GPDWRITE:
Builds the write test application: gpdwrite.exe<o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'><span
style="mso-spacerun: yes">       </span><span style="mso-spacerun:
yes">   </span>To build the projects, set the project in question to the active
project and click build.<o:p></o:p></span></p>

<p style='margin-left:.5in;text-indent:-.25in;mso-list:l1 level1 lfo4;
tab-stops:list .5in'><![if !supportLists]><span style='font-size:8.0pt;
mso-bidi-font-size:10.0pt;font-family:Wingdings'>q<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><span style='font-size:10.0pt;font-family:Verdana'>To
build from the command line, run setenv.bat from the Windows 2000 DDK
directory.<span style="mso-spacerun: yes">  </span>Then type build in the
project directory.<span style="mso-spacerun: yes">  </span>The driver and both
test applications will be built.<o:p></o:p></span></p>

<h4><span style='font-family:Verdana'>Driver Installation <o:p></o:p></span></h4>

<p><span style='font-size:10.0pt;font-family:Verdana'>To install the driver: <o:p></o:p></span></p>

<ol start=1 type=1>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l2 level1 lfo1;tab-stops:list .5in'><span style='font-size:10.0pt;
     font-family:Verdana'>Double-click the Add/Remove Hardware Wizard applet in
     Control Panel.<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l2 level1 lfo1;tab-stops:list .5in'><span style='font-size:10.0pt;
     font-family:Verdana'>Select Add/Troubleshoot a Device.<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l2 level1 lfo1;tab-stops:list .5in'><span style='font-size:10.0pt;
     font-family:Verdana'>Select Add a new device.<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l2 level1 lfo1;tab-stops:list .5in'><span style='font-size:10.0pt;
     font-family:Verdana'>Select No, I Want to Select the Hardware from a list.<o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l2 level1 lfo1;tab-stops:list .5in'><span style='font-size:10.0pt;
     font-family:Verdana'>Select Other Devices and then click Next. <o:p></o:p></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l2 level1 lfo1;tab-stops:list .5in'><span style='font-size:10.0pt;
     font-family:Verdana'>Click Have Disk and point to the directory that
     contains genport.inf file.<o:p></o:p></span></li>
</ol>

<p><span style='font-size:10.0pt;font-family:Verdana'>The system copies the
genport.sys file to %systemroot%\system32\drivers directory and loads the
driver. The INF file specifies two logical configuartion for the device.<o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'><br>
[PortIO.LC0]<br>
ConfigPriority=DESIRED <br>
IOConfig=300-303(3ff::) ; 10 bit decode ranging from 300 - 303<br>
<br>
[PortIO.LC1]<br>
ConfigPriority=NORMAL<br>
IOConfig=4@300-3ff(3ff::) ; 4 ports starting anywhere between 300 and 3fc<o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'>The system will first try
to assign the DESIRED configuration. If there is conflict then it will try to
assign any 4 consecutive port between 300 and 3fc as specified in the LC1
configuration.<o:p></o:p></span></p>

<h3><span style='font-family:Verdana'>TOOLS<o:p></o:p></span></h3>

<p><span style='font-size:10.0pt;font-family:Verdana'>To test your GENPORT
driver, do the following.<o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'>GpdRead -b 1 {This reads
a byte from assigned 'base port address + 1' } <o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'>GpdWrite -b 2 1 {This
writes 1 to assigned 'base port address + 2' } <o:p></o:p></span></p>

<p><span style='font-size:10.0pt;font-family:Verdana'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

<h3><span style='font-family:Verdana'>CODE TOUR<o:p></o:p></span></h3>

<h4><span style='font-family:Verdana'>File Manifest<o:p></o:p></span></h4>

<pre><u>File<span style='mso-tab-count:2'>           </span>Description<o:p></o:p></u></pre><pre><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></pre><pre
style='margin-left:1.0in;text-indent:-1.0in'>Genport.cpp<span style='mso-tab-count:
1'> </span><span style="mso-spacerun: yes">   </span>Source file for Generic Port I/O Driver with DriverWorks <span style="mso-spacerun: yes">   </span></pre><pre
style='margin-left:1.0in;text-indent:-1.0in'><span style="mso-spacerun: yes">              </span><span style="mso-spacerun: yes"> </span><span style="mso-spacerun: yes">   </span>modifications.</pre><pre>Portio.htm<span
style='mso-tab-count:1'>     </span>Sample Tour documentation for this sample (this file).</pre><pre>Sources<span
style='mso-tab-count:2'>        </span>Generic file for building the code sample.</pre><pre>genport.inf<span
style='mso-tab-count:1'>    </span>File for installing the driver.</pre><pre>Gpioctl.h<span
style='mso-tab-count:1'>      </span>Include file for defining IOCTL codes used by driver and test applications.</pre><pre>Gpdread.c<span
style='mso-tab-count:1'>      </span>Source file that shows how to read a byte from a port using</pre><pre><span style="mso-spacerun: yes">              </span><span style="mso-spacerun: yes"> </span><span style="mso-spacerun: yes">   </span>the genport driver.</pre><pre>Gpdwrite.c<span
style='mso-tab-count:1'>     </span>Source file that shows how to write a byte to a port using the</pre><pre><span style="mso-spacerun: yes">                 </span><span style="mso-spacerun: yes"> </span>genport driver.</pre><pre>Genport.h<span
style='mso-tab-count:1'>      </span>Include file for Generic Port I/O Driver.</pre>

<p align=center style='text-align:center'><span style='font-size:10.0pt;
font-family:Verdana'><a href="#top">Top of page</a> <o:p></o:p></span></p>

<table border=0 cellspacing=0 cellpadding=0 width=624 style='width:6.5in;
 mso-cellspacing:0in'>
 <tr style='height:1.5pt'>
  <td style='background:aqua;padding:.75pt .75pt .75pt .75pt;height:1.5pt'>
  <p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><span
  style='font-size:2.0pt;mso-bidi-font-size:12.0pt'><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<p><span style='font-size:10.0pt;font-family:Verdana'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></span></p>

</div>

</body>

</html>
